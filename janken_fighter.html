<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/sample.css" />
    <title>JANKEN FIGHTER II</title>
  </head>

  <body>
    <!-- タイトル -->
    <header>
      <h1>JANKEN FIGHTER II</h1>
    </header>

    <!-- 画像 -->
    <main>
      <img src="img/battle_ryu_ken.jpg" alt="" class="image" />

      <!-- メッセージウィンドウ -->
      <div id="message_window">ダメージは ・・・</div>

      <div class="ryu_ken_window">
        <!-- 必殺技リスト -->
        <div class="move_list">
          <p>あなたのわざをえらぶ▼</p>
          <ul>
            <li id="gu_btn">✊はどうけん</li>
            <li id="cho_btn">✌️しょうりゅうけん</li>
            <li id="par_btn">✋たつまきせんぷうきゃく</li>
          </ul>
        </div>

        <!-- 相手の技表示 -->
        <div class="com_move">
          <div>あいてのわざは ．．．．．</div>
          <div id="com_hand"></div>
        </div>
      </div>

      <!-- 音声 -->
      <audio src="audio/hadoken.mp3" id="hadoken" preload="auto"></audio>
      <audio src="audio/shoryuken.mp3" id="shoryuken" preload="auto"></audio>
      <audio
        src="audio/tatsumaki_senpukyaku.mp3"
        id="tatsumaki_senpukyaku"
        preload="auto"
      ></audio>
      <audio src="audio/KO.mp3" id="KO" preload="auto"></audio>
      <audio src="audio/You_win.mp3" id="You_win" preload="auto"></audio>
      <audio src="audio/You_lose.mp3" id="You_lose" preload="auto"></audio>
      <audio src="audio/winner.mp3" id="winner" preload="auto"></audio>
    </main>

    <footer></footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
      // 自分と相手の体力値
      let player_HP = 100;
      let com_HP = 100;

      // KO音声を関数化
      function KO() {
        // どちらかのHPが０以下になった場合
        if (player_HP <= 0 || com_HP <= 0) {
          // 音声
          $(function sound() {
            $("#KO").get(0).play();
          });
          $("#message_window").text("KO!!!");
        }
      }

      // グーの波動拳を選んだ時の音声
      $("#gu_btn").on("click", function sound() {
        $("#hadoken").get(0).currentTime = 0;
        $("#hadoken").get(0).play();
        console.log(player_HP);
        console.log(com_HP);
      });

      // グーの波動拳を選んだ時の処理
      $("#gu_btn").on("click", function () {
        // setTimeout_クリックしてから1.5秒後に実行
        setTimeout(function () {
          // ０〜２の乱数作成
          const randomNumber = Math.floor(Math.random() * 3);
          // 相手の技が決まって画面に表示され、音声が流れてダメージが表示される
          // グーの波動拳
          if (randomNumber == 0) {
            // 技名表示
            $("#com_hand").text("✊はどうけん");
            // ダメージ表示
            $("#message_window").text("うちけしあって、おたがいにダメージなし");
            // 音声
            $(function sound() {
              $("#hadoken").get(0).currentTime = 0;
              $("#hadoken").get(0).play();
            });
            // チョキの昇竜拳
          } else if (randomNumber == 1) {
            // 技名表示
            $("#com_hand").text("✌️しょうりゅうけん");
            // ダメージ表示
            $("#message_window").text("あいてに３０のダメージ");
            // ダメージ計算
            com_HP -= 30;
            // 音声
            $(function sound() {
              $("#shoryuken").get(0).currentTime = 0;
              $("#shoryuken").get(0).play();
            });
            // パーの竜巻旋風脚
          } else if (randomNumber == 2) {
            // 技名表示
            $("#com_hand").text("✋たつまきせんぷうきゃく");
            // ダメージ表示
            $("#message_window").text("あなたに３０のダメージ");
            // ダメージ計算
            player_HP -= 30;
            // 音声
            $(function sound() {
              $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
              $("#tatsumaki_senpukyaku").get(0).play();
            });
          } else {
            alert("エラー");
          }
          console.log(player_HP);
          console.log(com_HP);
          // setTimeout_クリックしてから1.5+1=2.5秒後に実行
          setTimeout(function () {
            // KO音声の関数を呼び出し
            KO();
          }, 1000);
        }, 1500);
      });

      // チョキの昇竜拳を選んだ時の音声
      $("#cho_btn").on("click", function sound() {
        $("#shoryuken").get(0).currentTime = 0;
        $("#shoryuken").get(0).play();
        console.log(player_HP);
        console.log(com_HP);
      });

      // チョキの昇竜拳を選んだ時の処理
      $("#cho_btn").on("click", function () {
        // setTimeout_クリックしてから1.5秒後に実行
        setTimeout(function () {
          // ０〜２の乱数作成
          const randomNumber = Math.floor(Math.random() * 3);
          // 相手の技が決まって画面に表示され、音声が流れてダメージが表示される
          // グーの波動拳
          if (randomNumber == 0) {
            // 技名表示
            $("#com_hand").text("✊はどうけん");
            // ダメージ表示
            $("#message_window").text("あなたに３０のダメージ");
            // ダメージ計算
            player_HP -= 30;
            // 音声
            $(function sound() {
              $("#hadoken").get(0).currentTime = 0;
              $("#hadoken").get(0).play();
            });
            // チョキの昇竜拳
          } else if (randomNumber == 1) {
            // 技名表示
            $("#com_hand").text("✌️しょうりゅうけん");
            // ダメージ表示
            $("#message_window").text(
              "あいうちとなり、おたがいに１０のダメージ"
            );
            // ダメージ計算
            player_HP -= 10;
            com_HP -= 10;
            // 音声
            $(function sound() {
              $("#shoryuken").get(0).currentTime = 0;
              $("#shoryuken").get(0).play();
            });
            // パーの竜巻旋風脚
          } else if (randomNumber == 2) {
            // 技名表示
            $("#com_hand").text("✋たつまきせんぷうきゃく");
            // ダメージ表示
            $("#message_window").text("あいてに３０のダメージ");
            // ダメージ計算
            com_HP -= 30;
            // 音声
            $(function sound() {
              $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
              $("#tatsumaki_senpukyaku").get(0).play();
            });
          } else {
            alert("エラー");
          }
          console.log(player_HP);
          console.log(com_HP);
          // setTimeout_クリックしてから1.5+1=2.5秒後に実行
          setTimeout(function () {
            // KO音声の関数を呼び出し
            KO();
          }, 1000);
        }, 1500);
      });

      // パーの竜巻旋風脚を選んだ時の音声
      $("#par_btn").on("click", function sound() {
        $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
        $("#tatsumaki_senpukyaku").get(0).play();
        console.log(player_HP);
        console.log(com_HP);
      });

      // パーの竜巻旋風脚を選んだ時の処理
      $("#par_btn").on("click", function () {
        // setTimeout_クリックしてから1.5秒後に実行
        setTimeout(function () {
          // ０〜２の乱数作成
          const randomNumber = Math.floor(Math.random() * 3);
          // 相手の技が決まって画面に表示され、音声が流れてダメージが表示される
          // グーの波動拳
          if (randomNumber == 0) {
            // 技名表示
            $("#com_hand").text("✊はどうけん");
            // ダメージ表示
            $("#message_window").text("あいてに３０のダメージ");
            // ダメージ計算
            com_HP -= 30;
            // 音声
            $(function sound() {
              $("#hadoken").get(0).currentTime = 0;
              $("#hadoken").get(0).play();
            });
            // チョキの昇竜拳
          } else if (randomNumber == 1) {
            // 技名表示
            $("#com_hand").text("✌️しょうりゅうけん");
            // ダメージ表示
            $("#message_window").text("あなたに３０のダメージ");
            // ダメージ計算
            player_HP -= 30;
            // 音声
            $(function sound() {
              $("#shoryuken").get(0).currentTime = 0;
              $("#shoryuken").get(0).play();
            });
            // パーの竜巻旋風脚
          } else if (randomNumber == 2) {
            // 技名表示
            $("#com_hand").text("✋たつまきせんぷうきゃく");
            // ダメージ表示
            $("#message_window").text(
              "あいうちとなり、おたがいに１０のダメージ"
            );
            // ダメージ計算
            player_HP -= 10;
            com_HP -= 10;
            // 音声
            $(function sound() {
              $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
              $("#tatsumaki_senpukyaku").get(0).play();
            });
          } else {
            alert("エラー");
          }
          console.log(player_HP);
          console.log(com_HP);
          // setTimeout_クリックしてから1.5+1=2.5秒後に実行
          setTimeout(function () {
            // KO音声の関数を呼び出し
            KO();
          }, 1000);
        }, 1500);
      });

      // 勝ち負けの音声とメッセージを関数化
      function win_lose() {
        // お互いのHPが同時に０になった場合
        if (player_HP == 0 && com_HP == 0) {
          // メッセージ表示
          $("#message_window").text("ダブルKO　ひきわけ");
          // 勝ち_プレイヤーのHPが０より大きく_かつ_コンピュータのHPが０以下の場合
        } else if (0 < player_HP && com_HP <= 0) {
          // 音声
          $(function sound() {
            $("#You_win").get(0).play();
          });
          // メッセージ表示
          $("#message_window").text("あなたのかち！！！");
          // 負け_プレイヤーのHPが０以下_かつ_コンピュータのHPが０より大きい場合
        } else if (player_HP <= 0 && 0 < com_HP) {
          // 音声
          $(function sound() {
            $("#You_lose").get(0).play();
          });
          // メッセージ表示
          $("#message_window").text("あなたのまけ");
        }
      }

      // 勝利メッセージ演出を関数化
      function winner_message() {
        // 勝ち_プレイヤーのHPが０より大きく_かつ_コンピュータのHPが０以下の場合
        if (0 < player_HP && com_HP <= 0) {
          // BGM
          $(function sound() {
            $("#winner").get(0).play();
          });
          // 画像切り替え
          $(".image").attr("src", "img/ryu_win.png");
          // 技リスト非表示
          $(".move_list").hide();
          $(".com_move").hide();
          // プレイヤーの勝利メッセージ
          $("#message_window").text(
            "しょうりゅうけん　を　やぶらぬかぎり おまえに　かちめはない！！"
          );
          // 負け_プレイヤーのHPが０以下_かつ_コンピュータのHPが０より大きい場合
        } else if (player_HP <= 0 && 0 < com_HP) {
          // BGM
          $(function sound() {
            $("#winner").get(0).play();
            // 画像切り替え
            $(".image").attr("src", "img/ryu_lose.png");
            // 技リスト非表示
            $(".move_list").hide();
            $(".com_move").hide();
            // コンピューターの勝利メッセージ
            $("#message_window").text(
              "くにへ　かえるんだな。おまえにも　かぞくがいるだろう・・・（このセリフいってみたかったんだよな）"
            );
          });
        }
      }

      $("#message_window").on("click", function () {
        win_lose();
        // setTimeout_クリックしてから2秒後に実行
        setTimeout(function () {
          winner_message();
        }, 2000);
      });
    </script>
  </body>
</html>
