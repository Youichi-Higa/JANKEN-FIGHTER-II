<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/style.css" />
    <title>JANKEN FIGHTER II</title>
  </head>

  <body>
    <!-- タイトル -->
    <header>
      <h1>JANKEN FIGHTER II</h1>
    </header>

    <!-- 体力ゲージ -->
    <ul class="HP_gage">
      <li class="HP_block" id="HP10">01</li>
      <li class="HP_block" id="HP20">02</li>
      <li class="HP_block" id="HP30">03</li>
      <li class="HP_block" id="HP40">04</li>
      <li class="HP_block" id="HP50">05</li>
      <li class="HP_block" id="HP60">06</li>
      <li class="HP_block" id="HP70">07</li>
      <li class="HP_block" id="HP80">08</li>
      <li class="HP_block" id="HP90">09</li>
      <li class="HP_block" id="HP100">10</li>
    </ul>

    <!-- 画像 -->
    <main>
      <img src="img/battle_ryu_ken.jpg" alt="" class="image" />

      <!-- メッセージウィンドウ -->

      <div id="message_window">ＲＯＵＮＤ　１　ＦＩＧＨＴ！</div>

      <div class="player_com_window">
        <!-- 必殺技リスト -->
        <div class="player_window">
          <p id="player_HP">あなたのＨＰ：100</p>
          <p>あなたのわざをえらぶ▼</p>
          <ul class="move_list">
            <li class="move" id="gu_btn">✊はどうけん</li>
            <li class="move" id="cho_btn">✌️しょうりゅうけん</li>
            <li class="move" id="par_btn">✋たつまきせんぷうきゃく</li>
          </ul>
        </div>

        <!-- 相手の技表示 -->
        <div class="com_window">
          <p id="com_HP">あいてのＨＰ：100</p>

          <div>あいてのわざは ．．．．．</div>
          <div id="com_hand"></div>
        </div>
      </div>

      <!-- 音声 -->
      <audio src="audio/hadoken.mp3" id="hadoken" preload="auto"></audio>
      <audio src="audio/shoryuken.mp3" id="shoryuken" preload="auto"></audio>
      <audio
        src="audio/tatsumaki_senpukyaku.mp3"
        id="tatsumaki_senpukyaku"
        preload="auto"
      ></audio>
      <audio src="audio/KO.mp3" id="KO" preload="auto"></audio>
      <audio
        src="audio/You_win_Perfect.mp3"
        id="You_win_Perfect"
        preload="auto"
      ></audio>
      <audio src="audio/You_win.mp3" id="You_win" preload="auto"></audio>
      <audio src="audio/You_lose.mp3" id="You_lose" preload="auto"></audio>
      <audio src="audio/winner.mp3" id="winner" preload="auto"></audio>
    </main>

    <footer></footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
      // 自分と相手の体力値
      let player_HP = 100;
      let com_HP = 100;

      // HP表示を関数化
      function HP_func() {
        if (player_HP < 0) {
          $("#player_HP").text("あなたのＨＰ：" + "0");
        } else if (com_HP < 0) {
          $("#com_HP").text("あいてのＨＰ：" + "0");
        } else {
          $("#player_HP").text("あなたのＨＰ：" + player_HP);
          $("#com_HP").text("あいてのＨＰ：" + com_HP);
        }
      }

      // KOの音声とメッセージを関数化
      function KO_func() {
        // どちらかのHPが０以下になった場合
        if (player_HP <= 0 || com_HP <= 0) {
          // 音声
          $(function sound() {
            $("#KO").get(0).play();
          });
          $("#message_window").text("ＫＯ！！！");
        }
      }

      // グーの波動拳を選んだ時の音声
      $("#gu_btn").on("click", function sound() {
        $("#hadoken").get(0).currentTime = 0;
        $("#hadoken").get(0).play();
        console.log(player_HP);
        console.log(com_HP);
      });

      // グーの波動拳を選んだ時の処理
      $("#gu_btn").on("click", function () {
        // setTimeout_クリックしてから1.5秒後に実行
        setTimeout(function () {
          // ０〜２の乱数作成
          const randomNumber = Math.floor(Math.random() * 3);
          // 相手の技が決まって画面に表示され、音声が流れてダメージが表示される
          // グーの波動拳
          if (randomNumber == 0) {
            // 技名表示
            $("#com_hand").text("✊はどうけん");
            // ダメージ表示
            $("#message_window").text("うちけしあって、おたがいにダメージなし");
            // 音声
            $(function sound() {
              $("#hadoken").get(0).currentTime = 0;
              $("#hadoken").get(0).play();
            });
            // チョキの昇竜拳
          } else if (randomNumber == 1) {
            // 技名表示
            $("#com_hand").text("✌️しょうりゅうけん");
            // ダメージ表示
            $("#message_window").text("あいてに３０のダメージ");
            // ダメージ計算
            com_HP -= 30;
            // 音声
            $(function sound() {
              $("#shoryuken").get(0).currentTime = 0;
              $("#shoryuken").get(0).play();
            });
            // パーの竜巻旋風脚
          } else if (randomNumber == 2) {
            // 技名表示
            $("#com_hand").text("✋たつまきせんぷうきゃく");
            // ダメージ表示
            $("#message_window").text("あなたに３０のダメージ");
            // ダメージ計算
            player_HP -= 30;
            // 音声
            $(function sound() {
              $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
              $("#tatsumaki_senpukyaku").get(0).play();
            });
          } else {
            alert("エラー");
          }
          // HP表示
          HP_func();
          console.log(player_HP);
          console.log(com_HP);
          // setTimeout_クリックしてから1.5+1=2.5秒後に実行
          setTimeout(function () {
            // KOの音声とメッセージの関数を実行
            KO_func();
          }, 1000);
        }, 1500);
      });

      // チョキの昇竜拳を選んだ時の音声
      $("#cho_btn").on("click", function sound() {
        $("#shoryuken").get(0).currentTime = 0;
        $("#shoryuken").get(0).play();
        console.log(player_HP);
        console.log(com_HP);
      });

      // チョキの昇竜拳を選んだ時の処理
      $("#cho_btn").on("click", function () {
        // setTimeout_クリックしてから1.5秒後に実行
        setTimeout(function () {
          // ０〜２の乱数作成
          const randomNumber = Math.floor(Math.random() * 3);
          // 相手の技が決まって画面に表示され、音声が流れてダメージが表示される
          // グーの波動拳
          if (randomNumber == 0) {
            // 技名表示
            $("#com_hand").text("✊はどうけん");
            // ダメージ表示
            $("#message_window").text("あなたに３０のダメージ");
            // ダメージ計算
            player_HP -= 30;
            // HP表示
            $("#player_HP").text(player_HP);
            // 音声
            $(function sound() {
              $("#hadoken").get(0).currentTime = 0;
              $("#hadoken").get(0).play();
            });
            // チョキの昇竜拳
          } else if (randomNumber == 1) {
            // 技名表示
            $("#com_hand").text("✌️しょうりゅうけん");
            // ダメージ表示
            $("#message_window").text(
              "あいうちとなり、おたがいに１０のダメージ"
            );
            // ダメージ計算
            player_HP -= 10;
            com_HP -= 10;
            // HP表示
            $("#player_HP").text(player_HP);
            $("#com_HP").text(com_HP);
            // 音声
            $(function sound() {
              $("#shoryuken").get(0).currentTime = 0;
              $("#shoryuken").get(0).play();
            });
            // パーの竜巻旋風脚
          } else if (randomNumber == 2) {
            // 技名表示
            $("#com_hand").text("✋たつまきせんぷうきゃく");
            // ダメージ表示
            $("#message_window").text("あいてに３０のダメージ");
            // ダメージ計算
            com_HP -= 30;
            // HP表示
            $("#com_HP").text(com_HP);
            // 音声
            $(function sound() {
              $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
              $("#tatsumaki_senpukyaku").get(0).play();
            });
          } else {
            alert("エラー");
          }
          // HP表示
          HP_func();
          console.log(player_HP);
          console.log(com_HP);
          // setTimeout_クリックしてから1.5+1=2.5秒後に実行
          setTimeout(function () {
            // KOの音声とメッセージの関数を実行
            KO_func();
          }, 1000);
        }, 1500);
      });

      // パーの竜巻旋風脚を選んだ時の音声
      $("#par_btn").on("click", function sound() {
        $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
        $("#tatsumaki_senpukyaku").get(0).play();
        console.log(player_HP);
        console.log(com_HP);
      });

      // パーの竜巻旋風脚を選んだ時の処理
      $("#par_btn").on("click", function () {
        // setTimeout_クリックしてから1.5秒後に実行
        setTimeout(function () {
          // ０〜２の乱数作成
          const randomNumber = Math.floor(Math.random() * 3);
          // 相手の技が決まって画面に表示され、音声が流れてダメージが表示される
          // グーの波動拳
          if (randomNumber == 0) {
            // 技名表示
            $("#com_hand").text("✊はどうけん");
            // ダメージ表示
            $("#message_window").text("あいてに３０のダメージ");
            // ダメージ計算
            com_HP -= 30;
            // HP表示
            $("#com_HP").text(com_HP);
            // 音声
            $(function sound() {
              $("#hadoken").get(0).currentTime = 0;
              $("#hadoken").get(0).play();
            });
            // チョキの昇竜拳
          } else if (randomNumber == 1) {
            // 技名表示
            $("#com_hand").text("✌️しょうりゅうけん");
            // ダメージ表示
            $("#message_window").text("あなたに３０のダメージ");
            // ダメージ計算
            player_HP -= 30;
            // HP表示
            $("#player_HP").text(player_HP);
            // 音声
            $(function sound() {
              $("#shoryuken").get(0).currentTime = 0;
              $("#shoryuken").get(0).play();
            });
            // パーの竜巻旋風脚
          } else if (randomNumber == 2) {
            // 技名表示
            $("#com_hand").text("✋たつまきせんぷうきゃく");
            // ダメージ表示
            $("#message_window").text(
              "あいうちとなり、おたがいに１０のダメージ"
            );
            // ダメージ計算
            player_HP -= 10;
            com_HP -= 10;
            // HP表示
            $("#player_HP").text(player_HP);
            $("#com_HP").text(com_HP);
            // 音声
            $(function sound() {
              $("#tatsumaki_senpukyaku").get(0).currentTime = 0;
              $("#tatsumaki_senpukyaku").get(0).play();
            });
          } else {
            alert("エラー");
          }
          // HP表示
          HP_func();
          console.log(player_HP);
          console.log(com_HP);
          // setTimeout_クリックしてから1.5+1=2.5秒後に実行
          setTimeout(function () {
            // KOの音声とメッセージの関数を呼び出し
            KO_func();
          }, 1000);
        }, 1500);
      });

      // 勝ち負けの音声とメッセージを関数化
      function win_lose_func() {
        // 引き分け_お互いのHPが同時に０になった場合
        if (player_HP == 0 && com_HP == 0) {
          // メッセージ表示
          $("#message_window").text("ダブルKO　ひきわけ");
          // パーフェクト勝利_プレイヤーのHPが100のまま_かつ_コンピュータのHPが０以下の場合
        } else if (player_HP == 100 && com_HP <= 0) {
          // 音声
          $(function sound() {
            $("#You_win_Perfect").get(0).play();
          });
          // メッセージ表示
          $("#message_window").text("ＰＥＲＦＥＣＴ");
        }
        // 勝ち_プレイヤーのHPが０より大きく_かつ_コンピュータのHPが０以下の場合
        else if (0 < player_HP && com_HP <= 0) {
          // 音声
          $(function sound() {
            $("#You_win").get(0).play();
          });
          // メッセージ表示
          $("#message_window").text("ＹＯＵ　ＷＩＮ");
          // 負け_プレイヤーのHPが０以下_かつ_コンピュータのHPが０より大きい場合
        } else if (player_HP <= 0 && 0 < com_HP) {
          // 音声
          $(function sound() {
            $("#You_lose").get(0).play();
          });
          // メッセージ表示
          $("#message_window").text("ＹＯＵ　ＬＯＳＥ");
        }
      }

      const player_win_message =
        "しょうりゅうけん　を　やぶらぬかぎり<br>おまえに　かちめはない！！</br>";

      const com_win_message =
        "くにへ　かえるんだな。<br>おまえにも　かぞくがいるだろう・・・</br>（このセリフいってみたかったんだよな）";

      // 勝利メッセージ演出を関数化
      function winner_message_func() {
        // 勝ち_プレイヤーのHPが０より大きく_かつ_コンピュータのHPが０以下の場合
        if (0 < player_HP && com_HP <= 0) {
          // BGM
          $(function sound() {
            $("#winner").get(0).play();
          });
          // 画像切り替え
          $(".image").attr("src", "img/ryu_win.png");
          // 技リスト非表示
          $(".player_com_window").hide();
          // プレイヤーの勝利メッセージ
          $("#message_window").html(player_win_message);
          // 負け_プレイヤーのHPが０以下_かつ_コンピュータのHPが０より大きい場合
        } else if (player_HP <= 0 && 0 < com_HP) {
          // BGM
          $(function sound() {
            $("#winner").get(0).play();
            // 画像切り替え
            $(".image").attr("src", "img/ryu_lose.png");
            // 技リスト非表示
            $(".player_com_window").hide();
            // コンピューターの勝利メッセージ
            $("#message_window").html(com_win_message);
          });
        }
      }

      $("#message_window").on("click", function () {
        win_lose_func();
        // setTimeout_クリックしてから2.3秒後に実行
        setTimeout(function () {
          winner_message_func();
        }, 2300);
      });
    </script>
  </body>
</html>
